# ç¬¬ä¸‰é˜¶æ®µéœ€æ±‚æ–‡æ¡£ï¼šæ™ºæ…§ (The Brain)

> **å‘¨æœŸ**: 6 å‘¨  
> **ç›®æ ‡**: æå‡ AI æ™ºèƒ½æ°´å¹³ï¼Œå®ç°è§’è‰²ä¸€è‡´æ€§å’Œå¯¼æ¼”æ¨¡å¼  
> **å‰ç½®æ¡ä»¶**: ç¬¬ä¸€é˜¶æ®µåŸºç¡€è®¾æ–½å®Œæˆ

---

## 1. é˜¶æ®µæ¦‚è¿°

ç¬¬ä¸‰é˜¶æ®µæ˜¯æŠ€æœ¯æ·±åº¦æœ€é«˜çš„é˜¶æ®µï¼Œèšç„¦äº AI è¡¨ç°åŠ›çš„æ ¸å¿ƒçªç ´ã€‚

| ä»»åŠ¡ç¼–å· | ä»»åŠ¡åç§° | ä¼˜å…ˆçº§ | é¢„è®¡å‘¨æœŸ |
|----------|----------|--------|----------|
| #12 | è§’è‰²ä¸€è‡´æ€§ç³»ç»Ÿ 2.0 | P0 | 3 å‘¨ |
| #13 | å¯¼æ¼”å¾®è°ƒæ¨¡å¼ | P0 | 2 å‘¨ |
| #14 | ç»Ÿä¸€æ¨¡å‹æ¥å…¥å±‚ | P1 | 1 å‘¨ |

---

## 2. ä»»åŠ¡ #12: è§’è‰²ä¸€è‡´æ€§ç³»ç»Ÿ 2.0

**ä¼˜å…ˆçº§**: P0  
**å…³è”**: AI è¡¨ç°åŠ› 2.1

### 2.1 ç°çŠ¶åˆ†æ

- å½“å‰æ–¹æ¡ˆ: ç®€å•çš„ Prompt æè¿° + ä¸‰è§†å›¾ CharacterSheet
- é—®é¢˜:
  - è·¨åœºæ™¯è§’è‰²å·®å¼‚æ˜æ˜¾
  - ç”¨æˆ·éœ€è¦å¤šæ¬¡é‡æ–°ç”Ÿæˆ
  - æ— æ³•å›ºå®šç‰¹å®šç”»é£

### 2.2 è§’è‰²åº“ç³»ç»Ÿ

#### 2.2.1 åŠŸèƒ½æè¿°

å»ºç«‹"æ¼”å‘˜è¡¨"æœºåˆ¶ï¼Œç”¨æˆ·å¯ä»¥åˆ›å»ºã€ç®¡ç†ã€å¤ç”¨è§’è‰²ã€‚

#### 2.2.2 æ•°æ®æ¨¡å‹

```dart
class Character {
  final String id;
  final String name;
  final String description;          // è§’è‰²æè¿°
  final String? referenceImageUrl;   // ç”¨æˆ·ä¸Šä¼ çš„å‚è€ƒå›¾
  final CharacterSheet? sheet;       // ä¸‰è§†å›¾
  final Map<String, String> attributes; // å±æ€§: å¹´é¾„ã€æ€§åˆ«ã€æœè£…ç­‰
  final DateTime createdAt;
  final DateTime updatedAt;
}

class CharacterSheet {
  final String frontViewUrl;   // æ­£é¢
  final String sideViewUrl;    // ä¾§é¢
  final String backViewUrl;    // èƒŒé¢
  final String combinedUrl;    // ç»„åˆå›¾
  final String styleHash;      // ç”»é£æŒ‡çº¹
}
```

#### 2.2.3 è§’è‰²åº“ UI

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ‘¥ æˆ‘çš„è§’è‰²åº“                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚ ğŸ˜Š â”‚ â”‚ ğŸ± â”‚ â”‚ ğŸ¤– â”‚ â”‚  +  â”‚       â”‚
â”‚  â”‚å°æ˜ â”‚ â”‚å’ªå’ª â”‚ â”‚æœºå™¨äººâ”‚ â”‚æ–°å»º â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜       â”‚
â”‚                                          â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€ æœ€è¿‘ä½¿ç”¨ â”€â”€â”€â”€â”€â”€â”€â”€               â”‚
â”‚  â€¢ å°æ˜ - ä¸Šæ¬¡ä½¿ç”¨: 2å¤©å‰                  â”‚
â”‚  â€¢ å’ªå’ª - ä¸Šæ¬¡ä½¿ç”¨: 5å¤©å‰                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 2.2.4 è§’è‰²åˆ›å»ºæµç¨‹

```mermaid
flowchart TD
    A[å¼€å§‹åˆ›å»º] --> B{é€‰æ‹©æ–¹å¼}
    B -->|æ–‡å­—æè¿°| C[è¾“å…¥æè¿°]
    B -->|ä¸Šä¼ å›¾ç‰‡| D[ä¸Šä¼ å‚è€ƒå›¾]
    C --> E[GLM ç”Ÿæˆè¯¦ç»†å±æ€§]
    D --> F[å›¾åƒåˆ†ææå–ç‰¹å¾]
    E --> G[ç”Ÿæˆä¸‰è§†å›¾]
    F --> G
    G --> H[ç”¨æˆ·ç¡®è®¤]
    H -->|æ»¡æ„| I[ä¿å­˜åˆ°è§’è‰²åº“]
    H -->|ä¸æ»¡æ„| J[é‡æ–°ç”Ÿæˆ/å¾®è°ƒ]
    J --> G
```

### 2.3 Seed æ§åˆ¶æœºåˆ¶

#### 2.3.1 åŠŸèƒ½æè¿°

å›ºå®šéšæœºç§å­ä»¥ä¿æŒç”»é£ä¸€è‡´æ€§ã€‚

#### 2.3.2 æŠ€æœ¯å®ç°

```dart
class SeedController {
  /// ä¸ºé¡¹ç›®ç”Ÿæˆå›ºå®šç§å­
  int generateProjectSeed() {
    return DateTime.now().millisecondsSinceEpoch % 2147483647;
  }
  
  /// åŸºäºè§’è‰²ç”Ÿæˆæ´¾ç”Ÿç§å­
  int deriveCharacterSeed(int projectSeed, String characterId) {
    return (projectSeed + characterId.hashCode) % 2147483647;
  }
}

// å›¾ç‰‡ç”Ÿæˆæ—¶æ³¨å…¥ Seed
class ImageGenerationRequest {
  final String prompt;
  final String? referenceImage;
  final int? seed;  // å›ºå®šç§å­
  
  Map<String, dynamic> toJson() => {
    'prompt': prompt,
    'reference_image': referenceImage,
    'seed': seed,
  };
}
```

### 2.4 FaceID/LoRA æ¢ç´¢ (å®éªŒæ€§)

#### 2.4.1 æŠ€æœ¯æ–¹æ¡ˆ

| æ–¹æ¡ˆ | æè¿° | å¯è¡Œæ€§ |
|------|------|--------|
| InstantID | äººè„¸ä¿æŒæŠ€æœ¯ | API ä¾èµ– |
| IP-Adapter | å›¾åƒæç¤ºé€‚é…å™¨ | ComfyUI é›†æˆ |
| LoRA è®­ç»ƒ | è‡ªå®šä¹‰æ¨¡å‹ | éœ€è¦å¤§é‡ç®—åŠ› |

#### 2.4.2 MVP æ–¹æ¡ˆ

ä¼˜å…ˆä½¿ç”¨ **IP-Adapter** æ–¹æ¡ˆï¼š

```dart
class IPAdapterRequest {
  final String prompt;
  final String faceImageUrl;      // äººè„¸å‚è€ƒ
  final String styleImageUrl;     // é£æ ¼å‚è€ƒ
  final double faceWeight;        // äººè„¸æƒé‡ 0.0-1.0
  final double styleWeight;       // é£æ ¼æƒé‡ 0.0-1.0
}
```

### 2.5 éªŒæ”¶æ ‡å‡†

- [ ] è§’è‰²åº“åˆ›å»º/ç¼–è¾‘/åˆ é™¤åŠŸèƒ½å®Œæ•´
- [ ] åŒä¸€è§’è‰²è·¨5ä¸ªåœºæ™¯ç›¸ä¼¼åº¦ > 85%
- [ ] ç”¨æˆ·"é‡æ–°ç”Ÿæˆ"æ¬¡æ•°ä¸‹é™ 50%
- [ ] Seed æ§åˆ¶åŠŸèƒ½å¯ç”¨

---

## 3. ä»»åŠ¡ #13: å¯¼æ¼”å¾®è°ƒæ¨¡å¼

**ä¼˜å…ˆçº§**: P0  
**å…³è”**: AI è¡¨ç°åŠ› 2.2

### 3.1 åŠŸèƒ½æè¿°

å¼•å…¥"äººæœºåä½œå¾ªç¯"ï¼Œè®©ç”¨æˆ·åƒå¯¼æ¼”ä¸€æ ·ç²¾ç»†æ§åˆ¶æ¯ä¸ªé•œå¤´ã€‚

### 3.2 åˆ†é•œå¾®è°ƒ

#### 3.2.1 äº¤äº’æµç¨‹

```mermaid
sequenceDiagram
    participant U as ç”¨æˆ·
    participant A as App
    participant AI as AI æ¨¡å‹
    
    U->>A: æŸ¥çœ‹åˆ†é•œé¢„è§ˆ
    U->>A: ç‚¹å‡»ä¸æ»¡æ„çš„åˆ†é•œ
    A->>U: æ‰“å¼€å¾®è°ƒé¢æ¿
    U->>A: ä¿®æ”¹ Prompt / é€‰æ‹© Re-roll
    A->>AI: å•ç‹¬é‡æ–°ç”Ÿæˆè¯¥åˆ†é•œ
    AI->>A: è¿”å›æ–°å›¾ç‰‡
    A->>U: å±•ç¤ºæ–°æ—§å¯¹æ¯”
    U->>A: ç¡®è®¤é‡‡ç”¨ / ç»§ç»­è°ƒæ•´
```

#### 3.2.2 å¾®è°ƒé¢æ¿ UI

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ¬ åˆ†é•œ #3 å¾®è°ƒ                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚   å½“å‰å›¾     â”‚  â”‚   æ–°ç”Ÿæˆ    â”‚       â”‚
â”‚  â”‚   [å›¾ç‰‡]     â”‚  â”‚   [å›¾ç‰‡]    â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚                                          â”‚
â”‚  åŸå§‹ Prompt:                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚ A cute cat fighting in the...   â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                          â”‚
â”‚  ä¿®æ”¹ Prompt:                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚ A cute cat fighting, close-up   â”‚     â”‚
â”‚  â”‚ shot, dramatic lighting...      â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                          â”‚
â”‚  [ğŸ”„ Re-roll] [âœ“ é‡‡ç”¨æ–°å›¾] [âœ— ä¿ç•™åŸå›¾]   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 3.2.3 å®ç°ä»£ç 

```dart
class SceneEditor {
  final ScreenplayController _controller;
  
  /// é‡æ–°ç”Ÿæˆå•ä¸ªåœºæ™¯
  Future<Scene> regenerateScene({
    required int sceneIndex,
    String? newPrompt,
    bool keepSeed = true,
  }) async {
    final scene = _controller.scenes[sceneIndex];
    
    final request = ImageGenerationRequest(
      prompt: newPrompt ?? scene.imagePrompt,
      referenceImage: scene.characterSheet?.combinedUrl,
      seed: keepSeed ? scene.seed : null,
    );
    
    final newImageUrl = await _controller.generateImage(request);
    
    return scene.copyWith(
      imageUrl: newImageUrl,
      imagePrompt: newPrompt ?? scene.imagePrompt,
    );
  }
}
```

### 3.3 è¿é•œæ§åˆ¶

#### 3.3.1 è¿é•œç±»å‹

| è¿é•œ | è‹±æ–‡ | æ•ˆæœæè¿° | Video Prompt æ³¨å…¥ |
|------|------|----------|-------------------|
| æ¨é•œ | Push In | é•œå¤´å‘å‰æ¨è¿› | "camera slowly pushes forward" |
| æ‹‰é•œ | Pull Out | é•œå¤´å‘åæ‹‰è¿œ | "camera pulls back to reveal" |
| æ¨ªæ‘‡ | Pan | é•œå¤´æ°´å¹³ç§»åŠ¨ | "camera pans from left to right" |
| ä¿¯ä»° | Tilt | é•œå¤´å‚ç›´ç§»åŠ¨ | "camera tilts upward" |
| ç¯ç»• | Orbit | é•œå¤´ç»•ä¸»ä½“è½¬åŠ¨ | "camera orbits around subject" |
| è·Ÿæ‹ | Track | é•œå¤´è·Ÿéšä¸»ä½“ | "camera tracks the subject" |
| é™æ­¢ | Static | é•œå¤´å›ºå®š | "static camera shot" |

#### 3.3.2 è¿é•œé€‰æ‹© UI

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ¥ è¿é•œè®¾ç½® - åœºæ™¯ #3                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                          â”‚
â”‚  [æ¨é•œ]  [æ‹‰é•œ]  [æ¨ªæ‘‡]  [ä¿¯ä»°]           â”‚
â”‚    â†“      â†‘      â†”      â†•              â”‚
â”‚                                          â”‚
â”‚  [ç¯ç»•]  [è·Ÿæ‹]  [é™æ­¢]                  â”‚
â”‚    â—‹      â†’      â–                       â”‚
â”‚                                          â”‚
â”‚  é¢„è§ˆæ•ˆæœ:                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚        [åŠ¨ç”»é¢„è§ˆåŒº]              â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 3.3.3 å®ç°ä»£ç 

```dart
enum CameraMotion {
  pushIn,
  pullOut,
  panLeft,
  panRight,
  tiltUp,
  tiltDown,
  orbit,
  track,
  static,
}

class CameraMotionInjector {
  static String injectMotion(String basePrompt, CameraMotion motion) {
    final motionPrompts = {
      CameraMotion.pushIn: 'camera slowly pushes forward, dolly in',
      CameraMotion.pullOut: 'camera pulls back to reveal the scene',
      CameraMotion.panLeft: 'smooth pan from right to left',
      CameraMotion.panRight: 'smooth pan from left to right',
      // ... å…¶ä»–è¿é•œ
    };
    
    return '$basePrompt, ${motionPrompts[motion]}';
  }
}
```

### 3.4 éªŒæ”¶æ ‡å‡†

- [ ] å•åœºæ™¯é‡æ–°ç”ŸæˆåŠŸèƒ½å®Œæ•´
- [ ] Prompt ç¼–è¾‘ UI å¯ç”¨
- [ ] æ”¯æŒ 7 ç§è¿é•œç±»å‹é€‰æ‹©
- [ ] è¿é•œæ•ˆæœç¬¦åˆé¢„æœŸ

---

## 4. ä»»åŠ¡ #14: ç»Ÿä¸€æ¨¡å‹æ¥å…¥å±‚

**ä¼˜å…ˆçº§**: P1  
**å…³è”**: å·¥ç¨‹ç¨³å¥æ€§ 1.4

### 4.1 åŠŸèƒ½æè¿°

æŠ½è±¡å‡ºç»Ÿä¸€çš„æ¨¡å‹æ¥å£ï¼Œæ”¯æŒå¤šå‚å•†åˆ‡æ¢ã€‚

### 4.2 æ¶æ„è®¾è®¡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚               åº”ç”¨å±‚                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚         Model Gateway (ç»Ÿä¸€ç½‘å…³)         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚ Gemini â”‚ â”‚ é€šä¹‰   â”‚ â”‚ SD/CF â”‚       â”‚
â”‚  â”‚Providerâ”‚ â”‚Providerâ”‚ â”‚Providerâ”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.3 æ¥å£å®šä¹‰

```dart
/// å›¾åƒç”Ÿæˆå™¨æ¥å£
abstract class ImageGenerator {
  String get providerName;
  
  Future<GenerationResult<String>> generate({
    required String prompt,
    String? referenceImage,
    int? seed,
    Map<String, dynamic>? options,
  });
  
  Future<bool> checkHealth();
}

/// è§†é¢‘ç”Ÿæˆå™¨æ¥å£
abstract class VideoGenerator {
  String get providerName;
  
  Future<GenerationResult<String>> generate({
    required String imageUrl,
    required String motionPrompt,
    int? seed,
    Map<String, dynamic>? options,
  });
  
  Future<bool> checkHealth();
}

/// é€šç”¨ç”Ÿæˆç»“æœ
class GenerationResult<T> {
  final T? data;
  final GenerationError? error;
  final Duration duration;
  final int retryCount;
  
  bool get isSuccess => error == null;
}
```

### 4.4 æ”¯æŒçš„æä¾›å•†

| ç±»å‹ | æä¾›å•† | æ¨¡å‹ | çŠ¶æ€ |
|------|--------|------|------|
| å›¾åƒ | Google Gemini | gemini-2.5-flash-image | å·²é›†æˆ |
| å›¾åƒ | é˜¿é‡Œé€šä¹‰ | é€šä¹‰ä¸‡ç›¸ | å¾…æ¥å…¥ |
| å›¾åƒ | å­—èŠ‚ | å³æ¢¦ (Jimeng) | å¾…æ¥å…¥ |
| å›¾åƒ | è‡ªå»º | SD WebUI | å¾…æ¥å…¥ |
| è§†é¢‘ | Google Veo | veo-3.1 | å·²é›†æˆ |
| è§†é¢‘ | å¿«æ‰‹å¯çµ | Kling | å¾…æ¥å…¥ |

### 4.5 æ¨¡å‹æ¸ é“ç®¡ç† UI

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  âš™ï¸ æ¨¡å‹é…ç½®                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  å›¾åƒç”Ÿæˆæ¨¡å‹:                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚ â— Gemini (æ¨è)                 â”‚     â”‚
â”‚  â”‚ â—‹ é€šä¹‰ä¸‡ç›¸                       â”‚     â”‚
â”‚  â”‚ â—‹ è‡ªå®šä¹‰ API                    â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                          â”‚
â”‚  è‡ªå®šä¹‰é…ç½®:                              â”‚
â”‚  Base URL:  [_____________________]     â”‚
â”‚  API Key:   [_____________________]     â”‚
â”‚  Model ID:  [_____________________]     â”‚
â”‚                                          â”‚
â”‚  [æµ‹è¯•è¿æ¥]  [ä¿å­˜é…ç½®]                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.6 å›é€€ç­–ç•¥

```dart
class ModelGateway {
  final List<ImageGenerator> _imageGenerators;
  
  Future<String> generateImage(ImageRequest request) async {
    for (final generator in _imageGenerators) {
      try {
        if (await generator.checkHealth()) {
          final result = await generator.generate(
            prompt: request.prompt,
            referenceImage: request.referenceImage,
          );
          if (result.isSuccess) {
            return result.data!;
          }
        }
      } catch (e) {
        // è®°å½•é”™è¯¯ï¼Œå°è¯•ä¸‹ä¸€ä¸ª
        _logger.warning('${generator.providerName} failed: $e');
      }
    }
    throw AllProvidersFailedException();
  }
}
```

### 4.7 éªŒæ”¶æ ‡å‡†

- [ ] æ¥å£æŠ½è±¡å®Œæˆ
- [ ] è‡³å°‘æ”¯æŒ 2 ä¸ªå›¾åƒç”Ÿæˆæä¾›å•†
- [ ] æ¨¡å‹é…ç½® UI å¯ç”¨
- [ ] å›é€€ç­–ç•¥æ­£å¸¸å·¥ä½œ

---

## 5. æŠ€æœ¯ä¾èµ–

### 5.1 æ–°å¢ä¾èµ–

```yaml
dependencies:
  # æ— æ–°å¢å¤–éƒ¨ä¾èµ–ï¼Œä¸»è¦æ˜¯æ¶æ„é‡æ„
```

### 5.2 API å¯¹æ¥

- é€šä¹‰ä¸‡ç›¸ API æ–‡æ¡£ç ”ç©¶
- å³æ¢¦ API æ¥å…¥å¯è¡Œæ€§è¯„ä¼°
- SD WebUI API è§„èŒƒ

---

## 6. é‡Œç¨‹ç¢‘ä¸æˆåŠŸæŒ‡æ ‡

| ä»»åŠ¡ | é‡Œç¨‹ç¢‘ | æˆåŠŸæŒ‡æ ‡ |
|------|--------|----------|
| è§’è‰²ä¸€è‡´æ€§ | è§’è‰²åº“ä¸Šçº¿ | è·¨åœºæ™¯ç›¸ä¼¼åº¦ > 85% |
| å¯¼æ¼”æ¨¡å¼ | å¾®è°ƒåŠŸèƒ½ä¸Šçº¿ | ç”¨æˆ·é‡æ–°ç”Ÿæˆæ¬¡æ•°ä¸‹é™ 50% |
| æ¨¡å‹æ¥å…¥å±‚ | å¤šå‚å•†æ”¯æŒ | æ”¯æŒ 2+ å›¾åƒæä¾›å•† |

**é˜¶æ®µæ€»ä½“æˆåŠŸæŒ‡æ ‡**: ç”¨æˆ·"é‡æ–°ç”Ÿæˆ"æ¬¡æ•°ä¸‹é™ 50%

---

## 7. éªŒæ”¶æ¸…å•

### é˜¶æ®µå®Œæˆæ ‡å‡†

- [ ] è§’è‰²åº“ CRUD åŠŸèƒ½å®Œæ•´
- [ ] ä¸‰è§†å›¾ç”Ÿæˆè´¨é‡æå‡
- [ ] Seed æ§åˆ¶åŠŸèƒ½å¯ç”¨
- [ ] åˆ†é•œå¾®è°ƒåŠŸèƒ½å®Œæ•´
- [ ] è¿é•œé€‰æ‹© UI å®Œæˆ
- [ ] ç»Ÿä¸€æ¨¡å‹æ¥å£å®Œæˆ
- [ ] è‡³å°‘æ¥å…¥ 2 ä¸ªå›¾åƒæä¾›å•†
- [ ] æ¨¡å‹é…ç½® UI å®Œæˆ
